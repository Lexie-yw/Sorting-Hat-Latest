# 分院帽

## 项目概况

分院帽是一款问答游戏，可将用户分到霍格沃茨的四个学院之一。是时候探索魔法了！

游戏目前支持7种语言：英语、简体中文、法语、德语、西班牙语、日语和意大利语。

## 团队成员：

分院帽游戏是由 MIIS 的三名研究生（见下表）创建和本地化的。

Ellie (Zhiqing) Wu | Lexie (Yiwen) Wang | Maud Grasmenil
:-: | :-: | :-:
设计、本地化 | 游戏开发、本地化项目管理 | 国际化、本地化
zhiqingw@middlebury.edu, zhiqingwu1998@gmail.com | yw2@middlebury.edu, lexieyww@gmail.com | mgrasmenil@middlebury.edu, maud.grasmenil@gmail.com

<!---
Note: This project is the final course project for Software Internationalization and Localization, taught by Professor David Mohr (dmohr@middlebury.edu).
-->

[列出的名称按字母顺序排列]

## 介绍

### 项目构思

分院帽是一款 C# 游戏，灵感来自哈利波特电影和问答游戏机制。游戏中有 11 道选择题。根据用户对问题的回答，分院帽将用户分到霍格沃茨的四个学院之一。

### 游戏背景

霍格沃茨魔法学校有四个学院：格兰芬多学院、斯莱特林学院、拉文克劳学院和赫奇帕奇学院。房子的每个创始人对什么是好的巫术有不同的看法，所以房子的准入要求是不同的。被霍格沃茨录取的新生必须参加分院帽测试，才能知道他们将被分到哪个学院。

### 游戏规则

将有11道选择题，测试用户的兴趣、爱好、性格等，根据他们的回答，计算出一个结果，告诉用户他们会进入哪个房子。

### 外部资源参考

- Development Related: https://www.mooict.com/c-tutorial-create-a-simple-multiple-choice-quiz-game-in-visual-studio/
- Content Related: https://harrypotter.fandom.com/wiki/Harry_Potter
- Image Assets: https://unsplash.com/

## 产品开发

[工程：游戏源代码]：一般一个小测验只有一个结果，正确率（参考外部资源）。然而，在我们的问答游戏中，根据用户的回答，他们将从四种可能的结果中分配一个结果。为了实现这一点，代码逻辑如下所示：

每个问题有四个选择，每个选择都与霍格沃茨的学院有关。我们为每个选择分配一个标签（格兰芬多、斯莱特林、拉文克劳和赫奇帕奇）。然后，当我们将答案存储到数组时，我们不存储实际选择的字符串，而是存储标签。用户完成测验后，我们会计算数组中哪个标签（房子）出现频率最高，然后我们就可以将用户分配到那个房子。

<div>
<img src="./README%20assets/Code%20example.png"><p>代码示例：将标签存储到数组中。 </p>
<img src="./README%20assets/Non-localized%20product1.png" width="450" height="400"><img src="./README%20assets/Non-localized%20product1.png" width="450" height="400"><p>已完成的非本地化项目。</p>
</div>

## 项目管理

### 工作日志：

主要有四个开发阶段：构思、游戏开发[源代码]、国际化和本地化。我们创建了一个产品开发计划 [Progress Tracker] 以供遵循，并亲自或在线会面了五次以完成该项目。

<div>
<img src="./README%20assets/Product%20development%20plan.png" height="500" width="500"><img src="./README%20assets/worklog.png" height="300" width="300"><p>产品开发计划和工作日志。</p>
</div>

### 本地化文件管理：

良好的资产管理是成功本地化的必要条件。 Sorting Hat 具有三种与本地化相关的资产：媒体、源文本和翻译。为确保这些资产井井有条且易于访问，它们被妥善分类并放入 Google Drive 上的三个不同文件夹中。

<div>
<img src="./README%20assets/Drive%20folder%20structure.png" height="500" width="500"><img src="./README%20assets/Media%20folder.png" height="300" width="300"><p> Media 文件夹下的 Google Drive 文件夹结构和资产。</p>
</div>

### 工具：

为确保产品、工程和本地化团队之间的顺畅协作，我们使用 Visual Studio Community 和 GitHub 进行代码开发，使用 Google Drive 进行一般文件管理，使用 Whatsapp 进行进度更新和调试聊天，并使用 Zoom 进行在线会议。

<div>
<img src="README%20assets/Git%20Repo.png"><p>分院帽游戏的 GitHub 存储库。</p>
</div>

## 国际化

本地化始于游戏开发的最早阶段。在这方面，.NET 框架使应用国际化变得相当容易。 Windows 窗体正确国际化后，我们只需在不同的资源文件中添加文本。

### 工程

1. 我们创建了一个语言切换器：带有不同语言的列表。对于下拉列表，分配了一个函数，该函数首先获取所选语言环境的文化信息（切换/案例），应用它（CurrentCulture 和 CurrentUICulture），然后清除并重新初始化表单。 CultureInfo 对象允许我们调整一些文化元素以适应目标语言环境，例如最终文本中使用的日期格式。

<div>
<img src="README%20assets/Language%20Switcher.png"><p>代码示例：语言切换器。</p>
</div>

1. 国际化可以在表单属性中完成（Designer.cs，“Localizable”：True）。从默认切换到不同的语言环境会自动为每个语言环境创建新的资源文件，我们可以在其中放置变量及其对应的字符串。

2. 然后通过创建变量而不是字符串（在资源文件中获取属性字符串）并避免连接，在代码中实现了字符串外部化。

<div>
<img src="README%20assets/Externalized%20Strings.png"><p>en-US 资源文件中的外部化字符串。</p>
</div>

### 设计国际化

在国际化过程中还必须考虑其他因素。文本大小：文本的大小必须适应每个区域设置以确保其可读性（例如，较小的汉字）。框大小：同样，一旦字符串被翻译，我们意识到在某些区域设置中有些问题太长，溢出文本框（多余的文本不会显示）。因此，我们在需要时调整了文本框的大小。将来，最好让框自动调整大小，以便它们可以适应内容的长度。布局：某些区域设置出现了一些布局问题：语言标签的位置在法语（法国）中发生了变化。纠正它会重新初始化我们的资源文件，因此，由于时间限制，它还没有完成。这向我们表明，在将字符串添加到资源文件之前必须完成设计。我们想要探索的另一个解决方案是为独立于 Form.cs 文件的外部化字符串创建资源文件。语言：编码：我们希望确保所有语言都被正确编码，而其他语言确实可以在以后进行编码。因此，我们使用了 Unicode 标准。字体：我们必须确保它们适用于所有语言（尤其是中文和日文字符）。一个想法是为拉丁文字、中文和日语文字使用不同的字体。

## 设计

### 通用界面设计

遵循分院帽的主题，我们 UI 设计的基本概念反映了哈利波特电影的整体美学，以及该系列的其他衍生产品。更具体地说，我们旨在复制 Pottermore 网站上提供的分院帽测验，该测验评估用户在一组与哈利波特系列相关的多项选择题中的回答。

为了重现原始故事霍格沃茨魔法学校的中世纪哥特式建筑风格，我们为 UI 选择了深色配色方案，并在背景中搭配皱纹的棕褐色纸张纹理。

设计过程中的一个挑战是为答案选择按钮选择合适的颜色。如前所述，这四所房子各有自己的代表色，分别是红色、黄色、蓝色和绿色。为避免使用与任何一栋房屋相同的颜色，我们将按钮构建为黑色背景和橙色文本，在解决问题的同时保留了中世纪风格并提高了易读性。

### 字体选择

在上一节的基础上，该游戏的一般 UI 设计过程的另一个方面涉及找到一种进一步突出风格的字体。在这种情况下，我们经过深思熟虑后选择的拉丁字母表字体是仿照哈利波特电影海报字体风格的Xéfora。如前所述，我们采用了 Unicode 标准来包含我们本地化到的语言所需的字符。因此，我们选择字体的另一个标准是选择一个包含所有需要的字符，以及西班牙语、法语和德语的基本重音符号的字体。另一方面，对于我们选择的两种CCJK，或者C(hinese) J(apanese)语言，我们在选择字体时遇到了类似的问题。虽然一种名为 Oriental 的字体入围了日语，但它只支持三种日语书写系统中的一种。因此，我们决定将我们游戏的中文和日文版本保留为默认字体。

<div>
<img src="README%20assets/German%20UI.png" width="500" height="350"><img src="README%20assets/Spanish%20UI.png" width="500" height="350"><p>分院帽游戏 UI 已本地化为德语和西班牙语。</p>
</div>

回到所选字体，虽然它适用于我们游戏的所有非 CCJK 版本，但字体尚未嵌入，这意味着它仅在操作系统安装了 Xéfora 时显示。下面显示了带有程式化字体的游戏演示。

我们在字体实现过程中遇到的另一个问题，也许是最关键的问题是 Visual Studio 对字体类型的限制。首先，Visual Studio 只支持 TrueType 字体（TTF），所以以后类似的项目要避免使用 OpenType 字体。

## 本土化

对于本地化，在整个过程中显而易见的挑战是异化与归化。

我们最终交付的目标再次是模仿原始 Pottermore 测验的风格。因此，题目中引入了很多英国独有的概念。其中一个例子是关于茶点小吃的问题。众所周知，英国人经常在一天中的特定时间享用茶和各种甜味和咸味小吃。尽管如此，这种做法在世界各国并不普遍，即使在欧洲国家也是如此。作为母语为法语和中文的团队，我们指出了这个问题并提出了两个可能的解决方案：在我们应用程序的本地化版本中对该问题添加本地化，或者保留英国精神并直接翻译。

最后我们一致认为，由于游戏的背景仍然是霍格沃茨，所以最好保持所有版本的一致性，保留游戏中的英伦元素。

扩展上面关于我们游戏本地化的语言部分的讨论，我们发现一个有助于更好地捕捉原始主题精神的工具是哈利波特粉丝数据库。官方翻译由热情的粉丝和作家保存在词汇表中，帮助我们在描述中实现更好的一致性和准确性。

尽管如此，尽管语气和语气的一致性至关重要，但在许多情况下，句子结构可能需要因语言而异。在将游戏本地化为七种不同语言后，我们的一项观察是，中文和日文测验或问题设计通常具有其他语言测验所没有的独特属性。在研究和集思广益时，我们收集了官方和非官方的哈利波特分类帽问题。显然有更多的问题用中文和日文写着“请选择以下一项：”。由于我们的项目规模相对较小，问题结构对问题的细微差别影响不大，因此我们选择保持所有问题结构一致。但是，在未来有更多问题的本地化项目中，这个问题将值得仔细考虑。

## 挑战/经验教训

C# 是一种很棒的国际化语言！资源文件应在表单属性完成后完成（否则您将不得不重新开始）。再次证明备份总是好的，备份是我们在其中翻译外部化字符串的 Excel 文件（Drive 文件夹，仅限团队成员访问）。将来添加其他语言会很快。然而，我们的代码中可能需要重新编写的一个元素是与语言选择器关联的函数：目前，它依赖于列表中语言的顺序。将来，我们可以重写代码，以便从所选语言的本机名称中找到用于 Current(UI)Culture 的 iso 代码。美学很重要，但格式标准和字形数据也很重要！在 Visual Studio 中为 C# 程序中的文本元素选择字体时，不是检查字体的视觉效果，而是验证格式标准是否与 VS 兼容，以及字形的数量和类型是否满足语言的要求你将要实施的。

## 潜在的改进领域

### 音乐背景

为了将哈利波特的氛围带入我们的测验，我们考虑在背景中添加其音乐主题。游戏设计不是任务的重点，但弄清楚如何实现这个想法有助于我们探索更多 C# Winform 功能。第一种方法是创建两个按钮（播放、停止）。在代码中，我们可以使用内置的媒体系统并创建一个 Soundplayer 变量，然后将其链接到音频文件 (SoundLocation) 并将播放和停止函数用作点击事件。我们的研究随后发现了一种在 Winform 中播放音乐的更简单的方法：Windows Media Player 是 .NET 框架的内置组件。该项目可以添加到工具箱中，然后嵌入到表单中并仅用几行代码进行编程。优点是用户不仅可以播放和停止音乐，还可以暂停/恢复和改变音量。这也适用于视频。在 WinForm 中使用 WMP 的代码

然而，对于我们的游戏来说，玩家的设计并不美观。在任何情况下，虽然这两种解决方案都以单独的形式工作，但它们在我们的应用程序中不起作用，这可能是由于我们指示如何获取音频资源文件的方式存在错误。此外，播放此文件可能是非法的，因为它受到版权的严格保护。从国际化的角度来看，在其他情况下，我们可能会考虑将音乐内容适应目标受众。因此，考虑如何将探路者外部化以便主要代码不会更改但会根据语言环境获取不同的文件会很有趣。

### 开始菜单和结束画面

由于时间限制，我们还没有为我们的游戏实现开始菜单，我们将其概念化以迎接玩家并为游戏设定整体氛围。

此外，我们还计划实现一个包含与分配给玩家的房屋相关的视觉元素的结束屏幕，以丰富 UI 并增强玩家参与度。

### 代码优化

目前，我们的游戏根据比较与每个房子相关的累积答案数量来为玩家分配房子。如果可能的话，我们希望在算法中加入更多的随机性，以提高游戏的不可预测性和娱乐性。
